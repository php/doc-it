<?xml version="1.0" encoding="utf-8"?>
<!-- EN-Revision: 2221e0e7e0de8207ca4766892f1cdbb6be7d30a7 Maintainer: lucalzetta Status: ready -->
<!-- $Revision$ -->

<chapter xml:id="install.pecl" xmlns="http://docbook.org/ns/docbook" xmlns:xlink="http://www.w3.org/1999/xlink">
 <title>Installazione dell'estensione PECL</title>

 <sect1 xml:id="install.pecl.intro">
  <title>Introduzione all'installazione di PECL </title>
  <simpara>
   <link xlink:href="&url.pecl;">PECL</link> è un repositopry di estensioi PHP 
   che sono rese disponibili attraverso il packagig system di  
   <link xlink:href="&url.php.pear;">PEAR</link>. Questa sezione del manuale intende 
   mostrare come ottenere e installare l'estensione PECL. 
  </simpara>
  <simpara>
   Queste istruzioni partono dal presupposto che <literal>/your/phpsrcdir/</literal> 
   sia il percorso per la vostra distribuzione di PHP e che <literal>extname</literal> 
   sia il nome dell'estensione PECL. In accordo con ciò, queste istruzioni presuppongono 
   una certa familiarità con <link xlink:href="&url.php.pear.cli;">i comandi Pear </link>. 
   Le  informazioni nel manuale di PEAR per i comandi <literal>pear</literal> si 
   applicano anche ai comandi <literal>pecl</literal>. 
  </simpara>
  <simpara>
   Tanto per capirci, un estensione condivisa deve essere costruita, installata e
   caricata. I metodi descritti prima mettono a disposizione varie istruzioni con 
   cui costruire e installare le estensioni, ma non le caricano automaticamente. 
   Le estensioni possono essere caricate aggiungendo una direttiva <link
   linkend="ini.extension">extension</link> al file &php.ini;, o attraverso l'uso 
   della funzione <function>dl</function>. 
  </simpara>
  <simpara>
   Quando costruiamo un modulo PHP è importante conoscere esattamente la versione 
   degli strumenti richiesti (autoconf, automake, libtool, etc.) Vedere anche 
   <link xlink:href="&url.php.anongit;">Istruzioni Git anonime</link> per i dettagli 
   sugli strumenti richiesti e le versioni richieste.
  </simpara>
 </sect1>

 <sect1 xml:id="install.pecl.downloads">
  <title>Scaricare le estensioni PECL</title>
  <simpara>
   Ci sono diverse opzioni per sacricare le estensioni PECL come: 
  </simpara>
  <itemizedlist>
   <listitem>
    <simpara>
     Il comando <literal>pecl install extname</literal> scarica le estensioni del 
     codice automaticamente, perciò, in questo caso non c'è bisogno di download 
     separati. 
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <link xlink:href="&url.pecl;">&url.pecl;</link>
    </simpara>
    <simpara>
     Il sito web di PECL contiene informazioni sulle differenti estensioni che 
     vengono offeret dalla squadra di sviluppo di PHP. Le informazioni disponibili 
     qui includono : ChangeLog, note di rilascio, prerequisiti e altri dettagli 
     simili. 
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <literal>pecl download extname</literal>
    </simpara>
    <simpara>
     Le estensioni di PECL hanno dei rilasci elencati nel sito web di PECL e sono 
     disponibili per il download e l'installazione usando il 
     <link xlink:href="&url.php.pear.cli;">comando pecl</link>. 
     Revisioni specifiche possono comunque essere specificate. 
    </simpara>
   </listitem>
   <listitem>
    <simpara>
     <acronym>SVN</acronym>
    </simpara>
    <simpara>
     La maggior parte delle estensioni PECL risiede anche in <acronym>SVN</acronym>.  
     Una vista basata sul web può essere visitata anche a <link xlink:href="&url.php.svn;pecl/">&url.php.svn;pecl/</link>.  
     Per scaricare direttamente da <acronym>SVN</acronym>, si può usare la seguente 
     sequenza di comandi: 
    </simpara>
    <para>
     <screen>
$ svn checkout http://svn.php.net/repository/pecl/extname/trunk extname
     </screen>
    </para>
   </listitem>
   <listitem>
    <simpara>
     Windows downloads
    </simpara>
    <simpara>
     I progetti compilati di PHP e le DLL di Windows per molte 
     estensioni PECL sulle rispettive pagine dei pacchetti. 
    </simpara>
   </listitem>
  </itemizedlist>
 </sect1>

 <sect1 xml:id="install.pecl.windows">
  <title>Installare una estensione PHP su Windows</title>
  <para>
   Su Windows ci sono due modi per caricare un'estensione di PHP: o compilarla 
   dentro PHP stesso, o caricare la DLL. Caricare un'estensione precompilata è 
   la via più facile e da preferire. 
  </para>
  <para>
   Per caricare un estensione, è necessario averla disponibile come file ".DLL" sul 
   proprio sistema. Tutte le estensioni vengono automaticamente e periodicamente 
   compilate dal gruppo PHP (si veda la prossima sezione per i download). 
  </para>
  <para>
   Per compilare un'estensione dentro PHP si dovrà fare riferimento alla documentazione della 
   <link linkend="install.windows.legacy.building"> compilazione da sorgente</link>.
  </para>
  <para>
   Per compilare un estensione standalone (aka un DLL file), fare riferimento alla 
   documentazione <link linkend="install.windows.legacy.building">compilazione da sorgente</link>. 
   Se il file DLL non è dispononibile ne sulla propria versione di PHP ne in PECL, 
   si potrebbe doverlo compilare prima di poter usare l'estensione. 
  </para>

  <sect2 xml:id="install.pecl.windows.find">
   <title>Dove trovare un estensione?</title>
   <para>
    Le estensioni di PHP sono normalmente nominate "php_*.dll" (dove l'asterisco 
    rappresenta il nome dell'estensione) e si trovano nella cartella "PHP\ext". 
   </para>
   <para>
    PHP naviga con le estensioni molto più velocemente della maggior parte degli 
    sviluppatori. Esse sono chimate "core" extensios (estensioni del nucleo). 
   </para>
   <para>
    Comunque, se si ha bisogno di una funzionalità non supportata da nessuna estensione 
    del nucleo, è possibile ancora trovarla su <link xlink:href="&url.pecl;">PECL</link>. 
    La Libreria della Comunità per le Estensioni di PHP (PECL) è un magazzino per 
    estensioni di PHP, dispone di una directory per tutte le estensioni conosciute e 
    indirizzi per facilitare il download e lo sviluppo di estensioni di PHP. 
   </para>
   <para>
    Se si è sviluppata un estensione per il proprio uso personale, è possibile pensare di 
    farla ospitare su PECL in modo che altri, con le stesse necessità, possano beneficiare 
    del nostro tempo. Un buon effetto è che si da ad altri l'opportunità di darci un 
    giudizio, un augurio, un ringraziamento, un rapporto sui problemi o la soluzione 
    di altri problemi. Prima di firmare la propria estensione per caricarla su PECL, 
    leggere <link xlink:href="&url.pecl.submit;">PECL submit</link>. 
   </para>
  </sect2>

  <sect2 xml:id="install.pecl.windows.which">
   <title>Quali estensioni scaricare?</title>
   <para>
    <emphasis>Molte volte si troveranno diverse versioni della stessa DLL:</emphasis>
    <itemizedlist>
     <listitem>
      <simpara>
       Differenti numeri di versione (Solo i primi due numeri potrebbero combaciare) 
      </simpara>
     </listitem>
     <listitem>
      <simpara>
       Differenti impostazioni di sicurezza dei thread 
      </simpara>
     </listitem>
     <listitem>
      <simpara>
       Differenti architetture hardware (x86, x64, ...)
      </simpara>
     </listitem>
     <listitem>
      <simpara>
       Differenti impostazioni di debug
      </simpara>
     </listitem>
     <listitem>
      <simpara>
       <literal>etc.</literal>
      </simpara>
     </listitem>
    </itemizedlist>
   </para>
   <para>
    Sarà bene tenere a mente che le nostre impostazioni per l'estensione possano 
    trovare riscontro in tutti gli eseguibili di PHP che usiamo. IL seguente 
    script di PHP ci dirà <emphasis>tutto</emphasis> sulle nostre impostazioni PHP: 
   </para>
   <para>
    <example>
     <title><function>phpinfo</function> call</title>
     <programlisting role="php">
<![CDATA[
<?php
phpinfo();
?>
]]>
     </programlisting>
    </example>
   </para>
   <para>
    Oppure dalla riga di comando digitare: 
    <screen>
<![CDATA[
drive:\\path\to\php\executable\php.exe -i
]]>
    </screen>
   </para>
  </sect2>

  <sect2 xml:id="install.pecl.windows.loading">
   <title>Caricare un estensione</title>
   <para>
    La via più comune per caricare un estensione PHP è includerla nel nostro file 
    di configurazione <filename>php.ini</filename>. 
    Si osservi che molte estensioni saranno già presenti nel vostro <filename>php.ini</filename> 
    e che sarà solo necessario rimuovere i punti e virgola per attivarle. 
   </para>
   <para>
    Si noti che, sulla versione 7.2.0 di PHP e superiori, il nome delle estensioni 
    può essere usato al posto del nome del file dell'estensione. COme questo sia 
    indipendente dal sistema operativo e facile, specialmente per i principianti. 
    Sta diventando la via raccomandata per specificare le estensioni da caricare. 
    I nomi dei file rimangono supportati per compatibilità con le versioni precedenti. 
   </para>
    <screen>
<![CDATA[
;extension=php_extname.dll
]]>
    </screen>
    <screen>
<![CDATA[
extension=php_extname.dll
]]>
    </screen>
    <screen>
<![CDATA[
; On PHP version 7.2 and up, prefer :
extension=extname
zend_extension=another_extension
]]>
    </screen>
   <para>
    Comunque, alcuni web server sono confusi perché non usano il file <filename>php.ini</filename> 
    per affiancare il vostro eseguibile PHP. Per trovare dove il vostro <filename>php.ini</filename> 
    risiede, si dovrà cercare il suo percorso in <function>phpinfo</function>: 
   </para>
    <screen>
<![CDATA[
Configuration File (php.ini) Path  C:\WINDOWS
]]>
    </screen>
    <screen>
<![CDATA[
Loaded Configuration File   C:\Program Files\PHP\5.2\php.ini
]]>
    </screen>
   <para>
    Dopo aver attivato un estensione, salvare il file <filename>php.ini</filename>, 
    riaviare il web server e verificare <function>phpinfo</function> di nuovo. 
    La nuova estensione dovrebbe avere ora la propria sezione. 
   </para>
  </sect2>

  <sect2 xml:id="install.pecl.windows.problemsolving">
   <title>Soluzione dei problemi</title>
   <para>
    Se l'estensione non appare in <function>phpinfo</function>, potete controllare i 
    vostri log per vedere da dove scaturisce il problema. 
   </para>
   <para>
    Se state usando PHP dalla riga di comando (CLI), il loading degli errori dell'estensione 
    può essere letto direttamente sullo schermo. 
   </para>
   <para>
    Se state usnado PHP come un web server, la localizzazione e il formato dei log 
    dipenderà dal vostro software. Leggete la documentazione relativa al vostro server 
    per localizzare i file di log, essa non non ha alcuna relazione con PHP per se stesso. 
   </para>
   <para>
    I problemi più comuni sono legati alla localizzazione del DLL, il valore di 
    "<link linkend="ini.extension-dir">extension_dir</link>" impostato all'interno di 
    <filename>php.ini</filename> li localizza. Inoltre errate impostazioni a compile-time 
    possono creare altri problemi. 
   </para>
   <para>
    Se il problema risiede in un impostazione confusa in fase di compilazione, probabilmente 
    non si è scaricata la DLL corretta. Tentare nuovamente di scaricare l'estensione con le 
    impostazioni corrette. Ancora una volta <function>phpinfo</function> può essere 
    di grande aiuto. 
   </para>
  </sect2>

 </sect1>
 
 <sect1 xml:id="install.pecl.pear">
  <title>COmpilare estensioni PECL condivise con un comando pecl</title>
  <simpara>
   PECL facilita la creazione di estensioni PHP condivise. Usando 
   <link xlink:href="&url.php.pear.cli;">pecl command</link>, si esegue il seguente: 
  </simpara>
  <para>
   <screen>
$ pecl install extname
   </screen>
  </para>
  <simpara>
   Questo scaricherà il codice di <emphasis>extname</emphasis>, 
   lo compilerà e installerà <filename>extname.so</filename> nella vostra 
   <link linkend="ini.extension-dir">extension_dir</link>.  
   <filename>extname.so</filename> può essere caricato attraverso &php.ini;. 
  </simpara>
  <simpara>
   Per impostazione predefinita il comando <literal>pecl</literal> non installa 
   pacchetti marcati come <literal>alpha</literal> o <literal>beta</literal>. 
   Se non sono disponibili pacchetti <literal>stabili</literal>, si possono installare 
   versioni <literal>beta</literal> usando il seguente comando: 
  </simpara>
  <para>
   <screen>
$ pecl install extname-beta
   </screen>
  </para>
  <para>
   E' anche possibile installare una versione specifica con il seguente comando: 
  </para>
  <para>
   <screen>
$ pecl install extname-0.1
   </screen>
  </para>
  <note>
   <para>
    Dopo aver abilitato l'estensione in &php.ini;, è richiesto il riavvio del 
    web server per l'applicazione delle modifiche. 
   </para>
  </note>
 </sect1>

 <sect1 xml:id="install.pecl.phpize">
  <title>Compilare estensioni PECL condivise con phpize</title>
  <simpara>
   A volte l'uso dell'installer <literal>pecl</literal> non è un opzione. Questo 
   perchè si è coperti da un firewall, oppure perché le estensioni che si vogliono 
   installare non sono disponibili in modo compatibile con i pacchetti PECL, così 
   come le estensioni non rilasciate prese da SVN. Se si ha necessità di montare 
   un estensione di questo tipo è posibile usare gli strumenti di montaggio di basso 
   livello per eseguire il montaggio manualmente. 
  </simpara>
  <simpara>
   Il comando <literal>phpize</literal> è usato per preparare il montaggio nell'ambiente 
   per le estensioni PHP. Nel seguente esempio, il codice sorgente di un estensione 
   si trovano in una directory nominata <filename>extname</filename>: 
  </simpara>
  <para>
   <screen>
<![CDATA[
$ cd extname
$ phpize
$ ./configure
$ make
# make install
]]>
   </screen>
  </para>
  <simpara>
   Un installazion andata a buon fine avrà creato un file <filename>extname.so</filename> 
   e l'avrà posizionato nella <link linkend="ini.extension-dir">directory delle estensioni di PHP</link>.  
   Sarà necessario modificare &php.ini; e aggiungere la riga <literal>extension=extname.so</literal>
   prima di poter usare l'estensione. 
  </simpara>
  <simpara>
   Se il sistema non supporta il comando <literal>phpize</literal>, e vengono usati 
   pacchetti (come RPM's), assicurarsi di installare anche la versione appropriata 
   di PHP che possa includere il comando <literal>phpize</literal> con i file di 
   intestazione appropriati per il montaggio di PHP e delle sue estensioni. 
  </simpara>
  <simpara>
   Eseguire <command>phpize --help</command> per visualizzare ulteriori informazioni d'uso 
  </simpara>
 </sect1>
 
 <sect1 xml:id="install.pecl.php-config">
  <title>php-config</title>
  
  <para>
   php-config è un semplice script della shell per ottenere informazioni sulla 
   configurazione dell'installazione di PHP. 
  </para>
  
  <para>
   Quando compiliamo un estensione o più di una, se ci sono più versioni di PHP installate 
   sul sistema, è possibile specificare per quale installazione si vogliono montare 
   le estensioni usando l'opzione <literal>--with-php-config</literal> durante la 
   configurazione, specificando il percorso del rispettivo script php-config. 
  </para>
  
  <para>
   La lista delle opzioni della riga di comando messe a disposizione dallo script 
   php-config, può essere ottenuta in qualsiasi momento eseguendo php-config con 
   l'opzione <option>-h</option> attivata: 
   <screen>
<![CDATA[
Usage: /usr/local/bin/php-config [OPTION]
Options:
  --prefix            [...]
  --includes          [...]
  --ldflags           [...]
  --libs              [...]
  --extension-dir     [...]
  --include-dir       [...]
  --php-binary        [...]
  --php-sapis         [...]
  --configure-options [...]
  --version           [...]
  --vernum            [...]
]]>
   </screen>
  </para>
  
  <para>
   <table>
    <title>Opzioni per la riga di comando</title>
    <tgroup cols="2">
     <thead>
      <row>
       <entry>Opzione</entry>
       <entry>Descrizione</entry>
      </row>
     </thead>
     <tbody>
      <row>
       <entry>--prefix</entry>
       <entry>Il prefisso della directory dove è installato PHP, ovvero /usr/local</entry>
      </row>
      <row>
       <entry>--includes</entry>
       <entry>Lista delle opzioni -I con tutti i file inclusi</entry>
      </row>
      <row>
       <entry>--ldflags</entry>
       <entry>LD Flags con cui PHP è stato compilato</entry>
      </row>
      <row>
       <entry>--libs</entry>
       <entry>Librerie extra con cui PHP è stato compilato</entry>
      </row>
      <row>
       <entry>--extension-dir</entry>
       <entry>Directory in cui vengono cercate le estensioni per impostazione predefinita</entry>
      </row>
      <row>
       <entry>--include-dir</entry>
       <entry>Prefisso delle Directory dove i file header sono installati per impostazione predefinita</entry>
      </row>
      <row>
       <entry>--php-binary</entry>
       <entry>Percorso completo per PHP CLI o i binari di CGI</entry>
      </row>
      <row>
       <entry>--php-sapis</entry>
       <entry>Mostra i moduli SAPI disponibili</entry>
      </row>
      <row>
       <entry>--configure-options</entry>
       <entry>Opzioni di configurazione per ricreare l'installazione di PHP corrente</entry>
      </row>
      <row>
       <entry>--version</entry>
       <entry>Versione di PHP</entry>
      </row>
      <row>
       <entry>--vernum</entry>
       <entry>Versione di PHP come numero intero</entry>
      </row>
     </tbody>
    </tgroup>
   </table>
  </para>
 </sect1>

 <sect1 xml:id="install.pecl.static">
  <title>Compilare estensioni PECL staticamente dentro PHP</title>
  <simpara>
   Si può trovare che sia necessario costruire un estensione PECL in modalità statica 
   all'interno dei codici binari di PHP. Per fare ciò è necessario posizionare 
   il percorso di ricerca dell'estensione su <filename>/your/phpsrcdir/ext/</filename> 
   e comunicare al sistema costruttore di PHP di rigenerare il proprio script di 
   configurazione. 
  </simpara>
  <para>
   <screen>
<![CDATA[
$ cd /your/phpsrcdir/ext
$ pecl download extname
$ gzip -d < extname.tgz | tar -xvf -
$ mv extname-x.x.x extname
]]>
   </screen>
  </para>
  <simpara>
   Questo si troverà nella seguente directory: 
  </simpara>
  <para>
   <screen>
    /your/phpsrcdir/ext/extname
   </screen>
  </para>
  <simpara>
   Da qui si deve forzare PHP a ricostruire lo script di configurazione e, quindi, 
   montare PHP come al solito. 
  </simpara>
  <para>
   <screen>
$ cd /your/phpsrcdir 
$ rm configure
$ ./buildconf --force
$ ./configure --help
$ ./configure --with-extname --enable-someotherext --with-foobar
$ make
$ make install
   </screen>
  </para>
  <note>
   <simpara>
    Per eseguire lo script 'buildconf' è necessario autoconf 2.13 e automake 1.4+ 
    (le versioni più recenti di autoconf potrebbero lavorare, ma non sono supportate). 
   </simpara>
  </note>
  <simpara>
   Se sia possibile usare <literal>--enable-extname</literal> o <literal>--with-extname</literal> 
   dipende dall'estensione. Tipicamente un'estensione che non richiede librerie esterne 
   usa <literal>--enable</literal>. Per accertarsi eseguire lo script successivo 
   dopo buildconf: 
  </simpara>
  <para>
   <screen>
$ ./configure --help | grep extname
   </screen>
  </para>
 </sect1>
</chapter>   

<!-- Keep this comment at the end of the file
Local variables:
mode: sgml
sgml-omittag:t
sgml-shorttag:t
sgml-minimize-attributes:nil
sgml-always-quote-attributes:t
sgml-indent-step:1
sgml-indent-data:t
indent-tabs-mode:nil
sgml-parent-document:nil
sgml-default-dtd-file:"~/.phpdoc/manual.ced"
sgml-exposed-tags:nil
sgml-local-catalogs:nil
sgml-local-ecat-files:nil
End:
vim600: syn=xml fen fdm=syntax fdl=2 si
vim: et tw=78 syn=sgml
vi: ts=1 sw=1
-->
